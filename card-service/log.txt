[INFO] Scanning for projects...
[INFO] 
[INFO] -----------------< com.broome.micro.bank:card-service >-----------------
[INFO] Building card-service 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:3.1.0:clean (default-clean) @ card-service ---
[INFO] Deleting /Users/robin/tutorial/microbank/card-service/target
[INFO] 
[INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ card-service ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] Copying 0 resource
[INFO] 
[INFO] --- maven-compiler-plugin:3.8.0:compile (default-compile) @ card-service ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 14 source files to /Users/robin/tutorial/microbank/card-service/target/classes
[INFO] 
[INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ card-service ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:3.8.0:testCompile (default-testCompile) @ card-service ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 4 source files to /Users/robin/tutorial/microbank/card-service/target/test-classes
[INFO] 
[INFO] --- maven-surefire-plugin:2.22.1:test (default-test) @ card-service ---
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.broome.micro.bank.CardCucumberIntegrationTest
14:13:52.501 [main] DEBUG org.springframework.test.context.BootstrapUtils - Instantiating TestContextBootstrapper for test class [com.broome.micro.bank.CardStepDefinitions] from class [org.springframework.boot.test.context.SpringBootTestContextBootstrapper]
14:13:52.529 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
14:13:52.533 [main] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [com.broome.micro.bank.CardStepDefinitions]: class path resource [com/broome/micro/bank/CardStepDefinitions-context.xml] does not exist
14:13:52.533 [main] DEBUG org.springframework.test.context.support.AbstractContextLoader - Did not detect default resource location for test class [com.broome.micro.bank.CardStepDefinitions]: class path resource [com/broome/micro/bank/CardStepDefinitionsContext.groovy] does not exist
14:13:52.533 [main] INFO org.springframework.test.context.support.AbstractContextLoader - Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
14:13:52.534 [main] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
14:13:52.633 [main] DEBUG org.springframework.test.context.support.ActiveProfilesUtils - Could not find an 'annotation declaring class' for annotation type [org.springframework.test.context.ActiveProfiles] and class [com.broome.micro.bank.CardStepDefinitions]
14:13:52.728 [main] DEBUG org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider - Identified candidate component class: file [/Users/robin/tutorial/microbank/card-service/target/classes/com/broome/micro/bank/CardServiceApplication.class]
14:13:52.729 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
14:13:52.883 [main] DEBUG org.springframework.boot.test.context.SpringBootTestContextBootstrapper - @TestExecutionListeners is not present for class [com.broome.micro.bank.CardStepDefinitions]: using defaults.
14:13:52.885 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
14:13:52.913 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@27508c5d, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@4f704591, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@4b5189ac, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@1e4d3ce5, org.springframework.test.context.support.DirtiesContextTestExecutionListener@3ddc6915, org.springframework.test.context.transaction.TransactionalTestExecutionListener@704deff2, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@379614be, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@404bbcbd, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@1e81f160, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@1acaf3d, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@6986852, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@1bab8268]
14:13:52.967 [main] DEBUG org.springframework.test.context.support.TestPropertySourceUtils - Adding inlined properties to environment: {spring.jmx.enabled=false, org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true, server.port=0}
2019-02-21 14:13:54.774  INFO 43219 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$74c216df] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.1.2.RELEASE)

2019-02-21 14:13:55.092  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : No active profile set, falling back to default profiles: default
2019-02-21 14:13:56.375  INFO 43219 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.
2019-02-21 14:13:56.523  INFO 43219 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 131ms. Found 1 repository interfaces.
2019-02-21 14:13:57.433  INFO 43219 --- [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=a2ce9ca6-c94a-3317-919f-90b1399a4130
2019-02-21 14:13:58.462  INFO 43219 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$58a813e2] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-02-21 14:13:58.532  INFO 43219 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration' of type [org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration$$EnhancerBySpringCGLIB$$74c216df] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2019-02-21 14:13:59.227  INFO 43219 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 0 (http)
2019-02-21 14:13:59.281  INFO 43219 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-02-21 14:13:59.282  INFO 43219 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.14]
2019-02-21 14:13:59.302  INFO 43219 --- [           main] o.a.catalina.core.AprLifecycleListener   : The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: [/Users/robin/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.]
2019-02-21 14:13:59.557  INFO 43219 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2019-02-21 14:13:59.558  INFO 43219 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 4436 ms
2019-02-21 14:14:00.115  INFO 43219 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2019-02-21 14:14:00.381  INFO 43219 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2019-02-21 14:14:00.572  INFO 43219 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2019-02-21 14:14:00.700  INFO 43219 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate Core {5.3.7.Final}
2019-02-21 14:14:00.703  INFO 43219 --- [           main] org.hibernate.cfg.Environment            : HHH000206: hibernate.properties not found
2019-02-21 14:14:00.792  INFO 43219 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.0.4.Final}
2019-02-21 14:14:01.047  INFO 43219 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
Hibernate: drop table card if exists
Hibernate: drop sequence if exists seq
Hibernate: create sequence seq start with 123456 increment by 100
Hibernate: create table card (card_number bigint not null, account_number bigint, blocked boolean, pin_code varchar(255), user_id varchar(255), primary key (card_number))
2019-02-21 14:14:01.995  INFO 43219 --- [           main] o.h.t.schema.internal.SchemaCreatorImpl  : HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@7aa3857b'
2019-02-21 14:14:01.998  INFO 43219 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2019-02-21 14:14:02.799  WARN 43219 --- [           main] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2019-02-21 14:14:02.799  INFO 43219 --- [           main] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2019-02-21 14:14:02.813  WARN 43219 --- [           main] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2019-02-21 14:14:02.813  INFO 43219 --- [           main] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2019-02-21 14:14:03.461  INFO 43219 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'
2019-02-21 14:14:03.553  WARN 43219 --- [           main] aWebConfiguration$JpaWebMvcConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2019-02-21 14:14:05.173  INFO 43219 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 50785 (http) with context path ''
2019-02-21 14:14:05.175  INFO 43219 --- [           main] .s.c.n.e.s.EurekaAutoServiceRegistration : Updating port to 50785
2019-02-21 14:14:05.188  INFO 43219 --- [           main] o.s.c.n.eureka.InstanceInfoFactory       : Setting initial instance status as: STARTING
2019-02-21 14:14:05.262  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2019-02-21 14:14:05.362  INFO 43219 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using JSON encoding codec LegacyJacksonJson
2019-02-21 14:14:05.363  INFO 43219 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using JSON decoding codec LegacyJacksonJson
2019-02-21 14:14:05.605  INFO 43219 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using XML encoding codec XStreamXml
2019-02-21 14:14:05.606  INFO 43219 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using XML decoding codec XStreamXml
2019-02-21 14:14:05.986  INFO 43219 --- [           main] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2019-02-21 14:14:06.025  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Application is null : false
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2019-02-21 14:14:06.026  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2019-02-21 14:14:06.337  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : The response status is 200
2019-02-21 14:14:06.343  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2019-02-21 14:14:06.348  INFO 43219 --- [           main] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2019-02-21 14:14:06.356  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1550754846353 with initial instances count: 4
2019-02-21 14:14:06.369  INFO 43219 --- [           main] o.s.c.n.e.s.EurekaServiceRegistry        : Registering application CARD-SERVICE with eureka with status UP
2019-02-21 14:14:06.370  INFO 43219 --- [           main] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1550754846370, current=UP, previous=STARTING]
2019-02-21 14:14:06.374  INFO 43219 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_CARD-SERVICE/192.168.43.177:card-service:0: registering service...
2019-02-21 14:14:06.394  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : Started CardStepDefinitions in 13.421 seconds (JVM running for 15.282)
Feature: Card functionalities

  Scenario: List cards       # src/test/resources/features/card.feature:3
2019-02-21 14:14:06.436  INFO 43219 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_CARD-SERVICE/192.168.43.177:card-service:0 - registration status: 204
2019-02-21 14:14:06.444  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:06.463  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
2019-02-21 14:14:06.518  INFO 43219 --- [           main] o.h.h.i.QueryTranslatorFactoryInitiator  : HHH000397: Using ASTQueryTranslatorFactory
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
2019-02-21 14:14:06.711  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:06.842  INFO 43219 --- [o-auto-1-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2019-02-21 14:14:06.842  INFO 43219 --- [o-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2019-02-21 14:14:06.876  INFO 43219 --- [o-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 34 ms
2019-02-21 14:14:06.952  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:06.952  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:06.953  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: call next value for seq
Hibernate: call next value for seq
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card # CardStepDefinitions.haveACard(String)
    When user 1 list cards   # CardStepDefinitions.listCards(String)
2019-02-21 14:14:07.481  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.491  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.491  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.491  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.529  INFO 43219 --- [o-auto-1-exec-2] c.b.micro.bank.services.CardService      : CARDNUMBER: 123456 PIN: null
2019-02-21 14:14:07.539  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:07.539  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARDS IS NOT NULL
    Then user 1 have 1 card  # CardStepDefinitions.userHaveCards(String,int)
2019-02-21 14:14:07.654  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:07.656  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:07.656  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:07.662  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:07.665  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:07.666  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@6cfac0bd, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@549debdb, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@1edf52e6, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@5ab06829, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6075a4ea, org.springframework.test.context.transaction.TransactionalTestExecutionListener@5b0d480c, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@3f2169e9, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@6689bf04, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@2b9615cb, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@1aea759d, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@2eb03908, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@5ead245]

  Scenario: Adding a card with correct info     # src/test/resources/features/card.feature:8
2019-02-21 14:14:07.669  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:07.679  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:07.703  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.713  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:07.714  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.714  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    When the user 1 adds a card with ok account # CardStepDefinitions.userAddsACard(String)
2019-02-21 14:14:07.723  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.727  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.727  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.727  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.732  INFO 43219 --- [o-auto-1-exec-4] c.b.micro.bank.services.CardService      : CARDNUMBER: 123457 PIN: null
2019-02-21 14:14:07.734  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:07.735  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARDS IS NOT NULL
    Then user 1 have 1 card                     # CardStepDefinitions.userHaveCards(String,int)
2019-02-21 14:14:07.736  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:07.737  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:07.738  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:07.740  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:07.742  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:07.743  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@3986b9e9, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6ddbbfbb, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@4f629aa4, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@3f12676, org.springframework.test.context.support.DirtiesContextTestExecutionListener@f348e10, org.springframework.test.context.transaction.TransactionalTestExecutionListener@3f22ce2a, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@64cec4d0, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@6e069ca9, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@45e9db77, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@6c930e7e, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@7e69bf78, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@24d097c8]

  Scenario: Adding a card with wrong info        # src/test/resources/features/card.feature:12
2019-02-21 14:14:07.744  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:07.753  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:07.759  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.766  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:07.767  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.767  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
    When the user 1 adds a card with bad account # CardStepDefinitions.userAddsACardWithBadAccount(String)
2019-02-21 14:14:07.783  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.786  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.786  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.786  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.792  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:0
2019-02-21 14:14:07.792  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARDS IS NOT NULL
    Then user 1 have 0 card                      # CardStepDefinitions.userHaveCards(String,int)
2019-02-21 14:14:07.794  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:07.795  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:07.796  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:07.801  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:07.802  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:07.803  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@3d01b609, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@38b7004d, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@5e25085, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@758655a9, org.springframework.test.context.support.DirtiesContextTestExecutionListener@458704ee, org.springframework.test.context.transaction.TransactionalTestExecutionListener@45b2d17b, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@5243d730, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@15afebcc, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@68722de3, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@3b18009f, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@77aeba9b, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@1db5de29]

  Scenario: Changing pin               # src/test/resources/features/card.feature:16
2019-02-21 14:14:07.805  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:07.817  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
2019-02-21 14:14:07.822  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.831  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:07.831  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.831  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card           # CardStepDefinitions.haveACard(String)
    When user 1 changes pin to 4321    # CardStepDefinitions.changePin(String,String)
2019-02-21 14:14:07.840  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.843  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.844  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.844  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.848  INFO 43219 --- [o-auto-1-exec-8] c.b.micro.bank.services.CardService      : CARDNUMBER: 123458 PIN: null
2019-02-21 14:14:07.851  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
    Then user 1 pin is changed to 4321 # CardStepDefinitions.userPinIs(String,String)
2019-02-21 14:14:07.855  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:07.856  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:07.856  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:07.860  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:07.864  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:07.864  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@6aaf1ce8, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6f26e775, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@3220833f, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@2e5c245d, org.springframework.test.context.support.DirtiesContextTestExecutionListener@3c862522, org.springframework.test.context.transaction.TransactionalTestExecutionListener@64c37088, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@524c3e54, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@1d7d968c, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@10df1f34, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@6fe77a97, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@5cea47a1, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@2d527346]

  Scenario: Blocking the card   # src/test/resources/features/card.feature:21
2019-02-21 14:14:07.866  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:07.876  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:07.881  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.892  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:07.893  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.893  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card    # CardStepDefinitions.haveACard(String)
2019-02-21 14:14:07.902  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.906  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.906  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.906  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.910  INFO 43219 --- [-auto-1-exec-10] c.b.micro.bank.services.CardService      : CARDNUMBER: 123459 PIN: null
2019-02-21 14:14:07.914  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:07.915  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.922  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.923  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.924  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : BLOCKING CARD id123459,cardNumber37730001,accnumber{}
2019-02-21 14:14:07.925  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : Looking for card 123459 account 37730001 user 1
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=? and card0_.card_number=? and card0_.account_number=?
2019-02-21 14:14:07.935  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : found card 123459 account 37730001 user 1
Hibernate: update card set account_number=?, blocked=?, pin_code=?, user_id=? where card_number=?
2019-02-21 14:14:07.945  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : RETURNING BLOCKED CARD 123459 and it is blocked:true
2019-02-21 14:14:07.945  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : response.body is null: false
2019-02-21 14:14:07.948  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.951  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.952  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.952  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.955  INFO 43219 --- [o-auto-1-exec-2] c.b.micro.bank.services.CardService      : CARDNUMBER: 123459 PIN: null
2019-02-21 14:14:07.957  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
    When user 1 blocks the card # CardStepDefinitions.blockCard(String)
2019-02-21 14:14:07.958  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:07.962  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:07.962  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:07.962  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:07.966  INFO 43219 --- [o-auto-1-exec-3] c.b.micro.bank.services.CardService      : CARDNUMBER: 123459 PIN: null
2019-02-21 14:14:07.969  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:07.970  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARD 37730001 is blocked: true
    Then user 1 card is blocked # CardStepDefinitions.theCardIsBlocked(String)
2019-02-21 14:14:07.973  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:07.974  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:07.975  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:07.978  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:07.980  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:07.981  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@360d3f47, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@1693d505, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@3d195d15, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@17b387ef, org.springframework.test.context.support.DirtiesContextTestExecutionListener@489b7559, org.springframework.test.context.transaction.TransactionalTestExecutionListener@4028aab2, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@37aea657, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@3ca9d3b2, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@2f8b48c3, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@2af31aba, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@682d8dad, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@1aebe759]

  Scenario: Paying with the card              # src/test/resources/features/card.feature:26
2019-02-21 14:14:07.983  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:07.991  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:07.998  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.008  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:08.008  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.008  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card                  # CardStepDefinitions.haveACard(String)
2019-02-21 14:14:08.016  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.019  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.019  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.019  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.023  INFO 43219 --- [o-auto-1-exec-5] c.b.micro.bank.services.CardService      : CARDNUMBER: 123460 PIN: null
2019-02-21 14:14:08.025  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.025  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARDS IS NOT NULL
    And user 1 have 1 card                    # CardStepDefinitions.userHaveCards(String,int)
2019-02-21 14:14:08.026  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : SHOULD RETURN GOOD TRANSACTION balance 200
    And the card have balance 200             # CardStepDefinitions.theCardHaveBalance(int)
2019-02-21 14:14:08.028  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.031  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.031  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.031  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.035  INFO 43219 --- [o-auto-1-exec-6] c.b.micro.bank.services.CardService      : CARDNUMBER: 123460 PIN: null
2019-02-21 14:14:08.037  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.037  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.056  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : trying to make a card payment!
2019-02-21 14:14:08.057  INFO 43219 --- [o-auto-1-exec-7] c.b.micro.bank.services.CardService      : Starting to process transaction with card 123460 and pin null
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.card_number=? and (card0_.pin_code is null)
2019-02-21 14:14:08.066  INFO 43219 --- [o-auto-1-exec-7] c.b.micro.bank.services.CardService      : RETURNING TRANSACTION
    When user 1 pays 50 with correct pin 1234 # CardStepDefinitions.pay(String,int,String)
    Then the payment is approved              # CardStepDefinitions.approvedPayment()
2019-02-21 14:14:08.091  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:08.092  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:08.092  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:08.095  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:08.096  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:08.097  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@7f839ec5, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@23f539df, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@b859355, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@1f24e33d, org.springframework.test.context.support.DirtiesContextTestExecutionListener@7c3223aa, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7683d632, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@513bec8c, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@693ed09d, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@4fc8163, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@6c26e588, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@62f73b0c, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@7dd2a5f7]

  Scenario: Paying with a blocked card                     # src/test/resources/features/card.feature:33
2019-02-21 14:14:08.099  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:08.129  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:08.136  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.145  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:08.145  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.145  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
2019-02-21 14:14:08.152  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.158  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.159  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.159  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.163  INFO 43219 --- [o-auto-1-exec-9] c.b.micro.bank.services.CardService      : CARDNUMBER: 123461 PIN: null
2019-02-21 14:14:08.175  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.175  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.180  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.180  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.182  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : BLOCKING CARD id123461,cardNumber37730001,accnumber{}
2019-02-21 14:14:08.182  INFO 43219 --- [-auto-1-exec-10] c.b.micro.bank.services.CardService      : Looking for card 123461 account 37730001 user 1
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=? and card0_.card_number=? and card0_.account_number=?
2019-02-21 14:14:08.184  INFO 43219 --- [-auto-1-exec-10] c.b.micro.bank.services.CardService      : found card 123461 account 37730001 user 1
Hibernate: update card set account_number=?, blocked=?, pin_code=?, user_id=? where card_number=?
2019-02-21 14:14:08.186  INFO 43219 --- [-auto-1-exec-10] c.b.micro.bank.services.CardService      : RETURNING BLOCKED CARD 123461 and it is blocked:true
2019-02-21 14:14:08.186  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : response.body is null: false
2019-02-21 14:14:08.189  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.192  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.192  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.192  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.195  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : CARDNUMBER: 123461 PIN: null
2019-02-21 14:14:08.199  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
    Given user 1 have a blocked card                       # CardStepDefinitions.haveABlockedCard(String)
2019-02-21 14:14:08.201  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.203  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.204  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.204  INFO 43219 --- [o-auto-1-exec-2] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.207  INFO 43219 --- [o-auto-1-exec-2] c.b.micro.bank.services.CardService      : CARDNUMBER: 123461 PIN: null
2019-02-21 14:14:08.209  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.209  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARDS IS NOT NULL
    And user 1 have 1 card                                 # CardStepDefinitions.userHaveCards(String,int)
2019-02-21 14:14:08.210  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.213  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.213  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.213  INFO 43219 --- [o-auto-1-exec-3] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.217  INFO 43219 --- [o-auto-1-exec-3] c.b.micro.bank.services.CardService      : CARDNUMBER: 123461 PIN: null
2019-02-21 14:14:08.219  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.219  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : CARD 37730001 is blocked: true
    And user 1 card is blocked                             # CardStepDefinitions.theCardIsBlocked(String)
2019-02-21 14:14:08.220  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.223  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.223  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.223  INFO 43219 --- [o-auto-1-exec-4] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.227  INFO 43219 --- [o-auto-1-exec-4] c.b.micro.bank.services.CardService      : CARDNUMBER: 123461 PIN: null
2019-02-21 14:14:08.229  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.229  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.239  INFO 43219 --- [o-auto-1-exec-5] c.b.m.bank.controller.CardController     : trying to make a card payment!
2019-02-21 14:14:08.239  INFO 43219 --- [o-auto-1-exec-5] c.b.micro.bank.services.CardService      : Starting to process transaction with card 123461 and pin 1234
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.card_number=? and card0_.pin_code=?
2019-02-21 14:14:08.244  INFO 43219 --- [o-auto-1-exec-5] c.b.micro.bank.services.CardService      : Card is blocked
    Then user 1 pays 50 with pin 1234 and its not approved # CardStepDefinitions.payNotApproved(String,int,String)
2019-02-21 14:14:08.248  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:08.250  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:08.250  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:08.255  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:08.257  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:08.257  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@23d07ad3, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6b30ff23, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@4fea23d6, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@5ace6611, org.springframework.test.context.support.DirtiesContextTestExecutionListener@7a689979, org.springframework.test.context.transaction.TransactionalTestExecutionListener@164db8f0, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@8a7cd7c, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@21f0cc97, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@1f6d3a81, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@641c8ba4, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@52667676, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@75559cd9]

  Scenario: Paying with wrong pin                          # src/test/resources/features/card.feature:39
2019-02-21 14:14:08.258  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:08.266  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:08.270  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.280  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:08.281  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.281  INFO 43219 --- [o-auto-1-exec-6] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card                               # CardStepDefinitions.haveACard(String)
2019-02-21 14:14:08.288  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : SHOULD RETURN GOOD TRANSACTION balance 200
    And the card have balance 200                          # CardStepDefinitions.theCardHaveBalance(int)
2019-02-21 14:14:08.291  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.294  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.294  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.294  INFO 43219 --- [o-auto-1-exec-7] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.298  INFO 43219 --- [o-auto-1-exec-7] c.b.micro.bank.services.CardService      : CARDNUMBER: 123462 PIN: null
2019-02-21 14:14:08.301  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.301  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.308  INFO 43219 --- [o-auto-1-exec-8] c.b.m.bank.controller.CardController     : trying to make a card payment!
2019-02-21 14:14:08.308  INFO 43219 --- [o-auto-1-exec-8] c.b.micro.bank.services.CardService      : Starting to process transaction with card 123462 and pin 4321
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.card_number=? and card0_.pin_code=?
2019-02-21 14:14:08.309  INFO 43219 --- [o-auto-1-exec-8] c.b.micro.bank.services.CardService      : Card is blocked
    Then user 1 pays 50 with pin 4321 and its not approved # CardStepDefinitions.payNotApproved(String,int,String)
2019-02-21 14:14:08.312  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.broome.micro.bank.CardStepDefinitions], using SpringBootContextLoader
2019-02-21 14:14:08.313  INFO 43219 --- [           main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.broome.micro.bank.CardStepDefinitions]: no resource found for suffixes {-context.xml, Context.groovy}.
2019-02-21 14:14:08.314  INFO 43219 --- [           main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.broome.micro.bank.CardStepDefinitions]: CardStepDefinitions does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2019-02-21 14:14:08.316  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.broome.micro.bank.CardServiceApplication for test class com.broome.micro.bank.CardStepDefinitions
2019-02-21 14:14:08.318  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2019-02-21 14:14:08.318  INFO 43219 --- [           main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@7505dcab, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6d94a966, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@24bdd996, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@445b4594, org.springframework.test.context.support.DirtiesContextTestExecutionListener@1f602930, org.springframework.test.context.transaction.TransactionalTestExecutionListener@57777c23, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@1d4c6e32, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@3a5ffea, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@1d126f07, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@71689ee2, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@f2b4303, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@23dda7a3]

  Scenario: Paying with a card with not enough funds       # src/test/resources/features/card.feature:44
2019-02-21 14:14:08.320  INFO 43219 --- [           main] c.broome.micro.bank.BaseIntegrationTest  : PORT: 0
2019-02-21 14:14:08.328  INFO 43219 --- [           main] c.b.micro.bank.services.CardService      : CLEANING IN SERVICE
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_
Hibernate: delete from card where card_number=?
2019-02-21 14:14:08.332  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.341  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : POST: Creating a new card
2019-02-21 14:14:08.341  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.341  INFO 43219 --- [o-auto-1-exec-9] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: insert into card (account_number, blocked, pin_code, user_id, card_number) values (?, ?, ?, ?, ?)
    Given user 1 have a card                               # CardStepDefinitions.haveACard(String)
2019-02-21 14:14:08.348  INFO 43219 --- [           main] c.broome.micro.bank.CardStepDefinitions  : SHOULD RETURN BAD TRANSACTION balance 0
    And the card have balance 0                            # CardStepDefinitions.theCardHaveBalance(int)
2019-02-21 14:14:08.349  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.353  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : GETTING ALL CARDS
2019-02-21 14:14:08.353  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : header in cardcontroller: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
2019-02-21 14:14:08.353  INFO 43219 --- [-auto-1-exec-10] c.b.m.bank.controller.CardController     : stripped header: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJJZCI6IjEiLCJleHAiOjE1NTExMTcyNDV9.rpnO6mjtxmoOFDzC_yE-D8sgQJZz8BaKEvVSrNwiz3St_Q05Y05z-Ixf0TdtI4Avm9t04oqbWkQxb5r4x19VbQ
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.user_id=?
2019-02-21 14:14:08.356  INFO 43219 --- [-auto-1-exec-10] c.b.micro.bank.services.CardService      : CARDNUMBER: 123463 PIN: null
2019-02-21 14:14:08.358  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : got cards:1
2019-02-21 14:14:08.359  INFO 43219 --- [           main] c.b.m.bank.helper.CardIntegrationTest    : NEWPORT: 50785
2019-02-21 14:14:08.366  INFO 43219 --- [o-auto-1-exec-1] c.b.m.bank.controller.CardController     : trying to make a card payment!
2019-02-21 14:14:08.367  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : Starting to process transaction with card 123463 and pin 1234
Hibernate: select card0_.card_number as card_num1_0_, card0_.account_number as account_2_0_, card0_.blocked as blocked3_0_, card0_.pin_code as pin_code4_0_, card0_.user_id as user_id5_0_ from card card0_ where card0_.card_number=? and card0_.pin_code=?
2019-02-21 14:14:08.368  INFO 43219 --- [o-auto-1-exec-1] c.b.micro.bank.services.CardService      : Card is blocked
    Then user 1 pays 50 with pin 1234 and its not approved # CardStepDefinitions.payNotApproved(String,int,String)

9 Scenarios (9 passed)
28 Steps (28 passed)
0m15.999s

[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 17.065 s - in com.broome.micro.bank.CardCucumberIntegrationTest
[INFO] Running com.broome.micro.bank.helper.CardIntegrationTest
[WARNING] Tests run: 1, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0.001 s - in com.broome.micro.bank.helper.CardIntegrationTest
2019-02-21 14:14:08.792  INFO 43219 --- [       Thread-7] o.s.c.n.e.s.EurekaServiceRegistry        : Unregistering application CARD-SERVICE with eureka with status DOWN
2019-02-21 14:14:08.792  WARN 43219 --- [       Thread-7] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1550754848792, current=DOWN, previous=UP]
2019-02-21 14:14:08.793  INFO 43219 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_CARD-SERVICE/192.168.43.177:card-service:0: registering service...
2019-02-21 14:14:08.797  INFO 43219 --- [       Thread-7] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'applicationTaskExecutor'
2019-02-21 14:14:08.800  INFO 43219 --- [       Thread-7] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2019-02-21 14:14:08.801  INFO 43219 --- [       Thread-7] .SchemaDropperImpl$DelayedDropActionImpl : HHH000477: Starting delayed evictData of schema as part of SessionFactory shut-down'
2019-02-21 14:14:08.802  INFO 43219 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_CARD-SERVICE/192.168.43.177:card-service:0 - registration status: 204
Hibernate: drop table card if exists
Hibernate: drop sequence if exists seq
2019-02-21 14:14:08.812  INFO 43219 --- [       Thread-7] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-197]
2019-02-21 14:14:08.812  INFO 43219 --- [       Thread-7] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2019-02-21 14:14:11.818  INFO 43219 --- [       Thread-7] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2019-02-21 14:14:11.829  INFO 43219 --- [       Thread-7] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_CARD-SERVICE/192.168.43.177:card-service:0 - deregister  status: 200
2019-02-21 14:14:11.844  INFO 43219 --- [       Thread-7] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2019-02-21 14:14:11.845  INFO 43219 --- [       Thread-7] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2019-02-21 14:14:11.853  INFO 43219 --- [       Thread-7] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
[INFO] 
[INFO] Results:
[INFO] 
[WARNING] Tests run: 10, Failures: 0, Errors: 0, Skipped: 1
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 29.249 s
[INFO] Finished at: 2019-02-21T14:14:13+01:00
[INFO] ------------------------------------------------------------------------
